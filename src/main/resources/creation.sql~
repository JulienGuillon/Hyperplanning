DROP TABLE IF EXISTS PERSON;
DROP TABLE IF EXISTS USERS;
DROP TABLE IF EXISTS VISITOR;
DROP TABLE IF EXISTS TEACHER;
DROP TABLE IF EXISTS STUDENT;
DROP TABLE IF EXISTS MAINTENANCE_TECHNICIAN;
DROP TABLE IF EXISTS RESPONSABLE;
DROP TABLE IF EXISTS NETWORK_ENGINEER;
DROP TABLE IF EXISTS STUDENT_TEACHER;
DROP TABLE IF EXISTS STUDENT_TUTELAGE;
DROP TABLE IF EXISTS SPECIFIC_TEACHER;
DROP TABLE IF EXISTS DELEGATED_STUDENT;
DROP TABLE IF EXISTS COURSE;
DROP TABLE IF EXISTS ROOM;
DROP TABLE IF EXISTS BATIMENT;


DROP DOMAIN IF EXISTS Promotion;
DROP DOMAIN IF EXISTS Domaine;
DROP DOMAIN IF EXISTS Sexe;
DROP DOMAIN IF EXISTS Institut;
DROP DOMAIN IF EXISTS Statut;
DROP DOMAIN IF EXISTS Roles;
DROP DOMAIN IF EXISTS typeOfRoom;



CREATE DOMAIN typeOfRoom AS VARCHAR
CHECK (
  VALUE IN ('TP', 'Amphi', 'Gymnase', 'Stade', 'Salle Chimie')
);

CREATE DOMAIN Promotion AS VARCHAR
CHECK (
  VALUE IN ('L1', 'l2', 'L3', 'M1', 'M2', 'D1', 'D2')
);

CREATE DOMAIN Domaine AS VARCHAR
CHECK (
  VALUE IN ('SI', 'BIO','PC','MASS','LEA','ECO','SUAPS')
);


CREATE DOMAIN Statut AS VARCHAR
CHECK(
  VALUE IN ('HOLDER', 'EXTERNAL_TEACHER','RESEARCHER','PARTICIPANT')
);


CREATE DOMAIN Sexe AS VARCHAR
CHECK(
  VALUE IN ('MAN','WOMAN')
);


CREATE DOMAIN Roles AS VARCHAR
CHECK(
  VALUE IN ('STUDENT', 'TEACHER','MAINTENANCE_TECHNICIAN','RESPONSABLE','NETWORK_ENGINEER','STUDENT_TEACHER','SPECIFIC_TEACHER','DELEGATED_STUDENT','VISITOR','STUDENT_TUTELAGE')
);


CREATE DOMAIN Institut AS VARCHAR
CHECK(
  VALUE IN ('FAC','IUT')
);

CREATE TABLE PERSON(
  nom VARCHAR(100),
  role Roles NOT NULL,
  PRIMARY KEY(nom)
);

CREATE TABLE USERS(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100),
  password VARCHAR(100)
);


CREATE TABLE VISITOR(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles NOT NULL,
  PRIMARY KEY (nom)
);


CREATE TABLE TEACHER(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  statut Statut NOT NULL,
  subject VARCHAR(100),
  PRIMARY KEY(nom)
);

CREATE TABLE STUDENT(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  domaine Domaine NOT NULL,
  promotion Promotion NOT NULL,
  institut Institut NOT NULL,
  PRIMARY KEY(nom)
);


CREATE TABLE MAINTENANCE_TECHNICIAN(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  PRIMARY KEY(nom)
);

CREATE TABLE RESPONSABLE(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  PRIMARY KEY(nom)
);

CREATE TABLE NETWORK_ENGINEER(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  PRIMARY KEY(nom)
);

CREATE TABLE STUDENT_TEACHER(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  suject VARCHAR(100) NOT NULL,
  PRIMARY KEY(nom)
);

CREATE TABLE STUDENT_TUTELAGE(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  tutelage VARCHAR(100)
);

CREATE TABLE SPECIFIC_TEACHER(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  subject VARCHAR(100) REFERENCES TEACHER(subject),
  PRIMARY KEY(nom)
);

CREATE TABLE DELEGATED_STUDENT(
  nom VARCHAR(100) REFERENCES PERSON(nom),
  role Roles REFERENCES PERSON(role),
  login VARCHAR(100) REFERENCES USERS(login),
  password VARCHAR(100) REFERENCES USERS(password),
  PRIMARY KEY(nom)
);

CREATE TABLE COURSE(
  day INTEGER,
  idweek INTEGER,
  subject VARCHAR(100),
  hour INTEGER,
  duree INTEGER,
  PRIMARY KEY (day,subject)
);

CREATE TABLE BATIMENT(
  batiment VARCHAR(100),
  domaineBatiment Domaine,
  PRIMARY KEY (batiment, domaineBatiment)
);

CREATE TABLE ROOM(
  batiment VARCHAR(100) REFERENCES BATIMENT(batiment),
  numRoom INTEGER,
  typeRoom typeOfRoom,
  capacity INTEGER,
  PRIMARY KEY (batiment, numRoom)
);

INSERT INTO BATIMENT VALUES ('A', 'SI');
INSERT INTO BATIMENT VALUES ('B', 'SI');
INSERT INTO BATIMENT VALUES ('C', 'BIO');

INSERT INTO ROOM VALUES ('A', 1);
INSERT INTO ROOM VALUES ('A', 2);
INSERT INTO ROOM VALUES ('B',1);
INSERT INTO ROOM VALUES ('B', 2);

INSERT INTO COURSE VALUES (19, 43, 'MATH', 8, 1);
INSERT INTO COURSE VALUES (19, 43, 'JAVA', 9, 1);
INSERT INTO COURSE VALUES (19, 43, 'E', 10, 1);
INSERT INTO COURSE VALUES (19, 43, 'C', 11, 1);
INSERT INTO COURSE VALUES (19, 43, 'D', 14, 1);
INSERT INTO COURSE VALUES (20, 43, 'PROJET', 8, 1);


INSERT INTO PERSON VALUES ('Caltot' ,'STUDENT');
INSERT INTO PERSON VALUES ('Guillon','TEACHER');
INSERT INTO PERSON VALUES ('Prevot','MAINTENANCE_TECHNICIAN');
INSERT INTO PERSON VALUES ('Martinez','VISITOR');
INSERT INTO PERSON VALUES ('Pesnel','DELEGATED_STUDENT');
INSERT INTO PERSON VALUES ('Lebret','SPECIFIC_TEACHER');
INSERT INTO PERSON VALUES ('Cauty','STUDENT_TUTELAGE');
INSERT INTO PERSON VALUES ('Farge','STUDENT_TEACHER');
INSERT INTO PERSON VALUES ('Guard','NETWORK_ENGINEER');
INSERT INTO PERSON VALUES ('Betz','RESPONSABLE');




INSERT INTO USERS VALUES ('Caltot' ,'STUDENT','scaltot904' ,'scaltot904');
INSERT INTO USERS VALUES ('Guillon','TEACHER','jguillon725','$2a$12$e8r2pbPJe/Dze7Hs1Ot88eCHmQlyGtxAE3zPpGTI909lX5OVOdbKC');
INSERT INTO USERS VALUES ('Prevot','MAINTENANCE_TECHNICIAN','prevot','prevot');
INSERT INTO USERS VALUES ('Pesnel','DELEGATED_STUDENT','mpesnel','pesnel');
INSERT INTO USERS VALUES ('Lebret','SPECIFIC_TEACHER','lebret69','XXXX');
INSERT INTO USERS VALUES ('Cauty','STUDENT_TUTELAGE','cauty','cauty');
INSERT INTO USERS VALUES ('Farge','STUDENT_TEACHER','farge','farge');
INSERT INTO USERS VALUES ('Guard','NETWORK_ENGINEER','guard','guard');
INSERT INTO USERS VALUES ('Betz','RESPONSABLE','betz','betz');




INSERT INTO VISITOR VALUES ('Martinez','VISITOR');




INSERT INTO STUDENT VALUES ('Caltot' ,'STUDENT','scaltot904' ,'scaltot904','SI','M1','FAC');
INSERT INTO STUDENT VALUES ('Cauty','STUDENT_TUTELAGE','cauty','cauty','SI','M1','FAC');

INSERT INTO TEACHER VALUES ('Guillon','TEACHER','jguillon725','$2a$12$e8r2pbPJe/Dze7Hs1Ot88eCHmQlyGtxAE3zPpGTI909lX5OVOdbKC'
,'HOLDER','math');
INSERT INTO TEACHER VALUES ('Farge','STUDENT_TEACHER','farge','farge','PARTICIPANT','java');
INSERT INTO TEACHER VALUES ('Lebret','SPECIFIC_TEACHER','lebret69','XXXX','HOLDER','sport');

INSERT INTO MAINTENANCE_TECHNICIAN VALUES ('Prevot','MAINTENANCE_TECHNICIAN','prevot','prevot');

INSERT INTO RESPONSABLE VALUES ('Betz','RESPONSABLE','betz','betz');

INSERT INTO NETWORK_ENGINEER VALUES ('Guard','NETWORK_ENGINEER','guard','guard');

INSERT INTO STUDENT_TEACHER VALUES ('Farge','STUDENT_TEACHER','farge','farge','Java');

INSERT INTO SPECIFIC_TEACHER VALUES ('Lebret','SPECIFIC_TEACHER','lebret69','XXXX','sport');

INSERT INTO STUDENT_TUTELAGE VALUES ('Cauty','STUDENT_TUTELAGE','cauty','cauty','english');

